!function(t){function e(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,o){"use strict";var r=function(){function t(){this.fromLine=[],this.toLine=[],this.NodeType=null}return t.prototype.recordLine=function(t,e){"from"==t?this.fromLine.push(e):"to"==t&&this.toLine.push(e)},t.prototype.syncLineMove=function(t){"function"!=typeof t&&(t=function(t,e){});for(var e=this.fromLine,o=this.toLine,r=0;r<e.length;r++){var i=e[r].c;i.attr("path");t(i,"from",e[r])}for(var n=0;n<o.length;n++){t(o[n].c,"to",o[n])}},t.prototype.toJson=function(){var t={NodeType:this.NodeType,opt:this.opt,c:{attr:this.c.attr()}};return this.label&&(t.label={attr:this.label.attr()}),t},t}();e.a=r},function(t,e,o){"use strict";var r=o(0),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=function(t){function e(e){var o=t.call(this)||this;return o.NodeType="judge",o.instance=e,o.opt={},o}return i(e,t),e.prototype.onlyCell=function(t,e,o,r){this.opt={cx:t,cy:e,w:o,h:r};var i=this.getAp(),n=this.getBp(),a=this.getCp(),s=this.getDp();return this.instance.path("M"+i.x+","+i.y+"L"+n.x+","+n.y+"L"+a.x+","+a.y+"L"+s.x+","+s.y+"Z")},e.prototype.create=function(t){this.opt=t,this.minWidth=t.w;var e=this.getAp(),o=this.getBp(),r=this.getCp(),i=this.getDp();this.c=this.instance.path("M"+e.x+","+e.y+"L"+o.x+","+o.y+"L"+r.x+","+r.y+"L"+i.x+","+i.y+"Z");var n;n=t.text?this.instance.text(t.cx,t.cy,t.text):this.instance.text(t.cx,t.cy),this.label=n,this.resizeByText()},e.prototype.resizeByText=function(){if(this.label){var t=this.label.getBBox(),e=Math.ceil(t.width),o=this.c.attr("w");if(e<this.minWidth&&o<this.minWidth)return;e<this.minWidth?e=this.minWidth:e+=25,this.opt.w=e,this.resizeByOpt()}},e.prototype.resizeByOpt=function(){var t=this.getAp(),e=this.getBp(),o=this.getCp(),r=this.getDp();this.c.attr("path",[["M",t.x,t.y],["L",e.x,e.y],["L",o.x,o.y],["L",r.x,r.y],["Z"]])},e.prototype.move=function(t,e){var o=this.getCpByAp(t,e),r=this.getBp(o.x,o.y),i=this.getCp(o.x,o.y),n=this.getDp(o.x,o.y);this.c.attr("path",[["M",t,e],["L",r.x,r.y],["L",i.x,i.y],["L",n.x,n.y],["Z"]]),this.opt.cx=o.x,this.opt.cy=o.y,this.label.attr(o)},e.prototype.ToSyncLine=function(t,e){var o=this,r=this.getCpByAp(t,e);this.syncLineMove(function(t,e,i){var n,a=i.position;if("from"==e){n="get"+a.from+"p";var s=o[n](r.x,r.y),p=t.attr("path");p[0]=["M",s.x,s.y],t.attr("path",p)}else if("to"==e){n="get"+a.to+"p";var c=o[n](r.x,r.y),h=t.attr("path");h[h.length-1]=["L",c.x,c.y],t.attr("path",h)}})},e.prototype.ToSyncArrow=function(t,e){var o=this,r=this.getCpByAp(t,e);this.syncLineMove(function(t,e,i){var n,a=i.position;if("from"==e){n="get"+a.from+"p";var s=o[n](r.x,r.y);i.updatePath([s.x,s.y])}else if("to"==e){n="get"+a.to+"p";var p=o[n](r.x,r.y);i.updatePath(null,[p.x,p.y])}})},e.prototype.getStlnP=function(t){var e=this["get"+(t=t||"D")+"p"]();this.isCoincidence(e,"from")&&(e=this.getCp(),t="C");return{x:e.x,y:e.y,position:t}},e.prototype.getEnlnP=function(t){var e=this["get"+(t=t||"B")+"p"]();return e.position=t,e},e.prototype.getCpByAp=function(t,e){return t+=this.opt.w/2,{x:t,y:e}},e.prototype.getAp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t-=o.w/2,{x:t,y:e}},e.prototype.getBp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,e-=o.h/2,{x:t,y:e}},e.prototype.getCp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t+=o.w/2,{x:t,y:e}},e.prototype.getDp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,e+=o.h/2,{x:t,y:e}},e.prototype.isCoincidence=function(t,e){var o=!1;if(t&&"object"==typeof t&&void 0!==t.x&&void 0!==t.y)if("from"==e){if(this.fromLine.length>0)for(var r=0;r<this.fromLine.length;r++){if((a=(n=this.fromLine[r].c.attr("path"))[0])[1]==t.x&&a[2]==t.y){o=!0;break}}}else if("to"==e&&this.toLine.length>0)for(var i=0;i<this.toLine.length;i++){var n,a;if((a=(n=this.toLine[i].c.attr("path"))[n.length-1])[1]==t.x&&a[2]==t.y){o=!0;break}}return o},e}(r.a);e.a=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(3),i=o(1),n=o(4),a=o(11),s={type:1,text:"开始"},p={type:2,text:"任务"},c={type:3,text:"判断"},h={type:9,text:"结束"},u={type:1801,text:"箭头"},f={type:1802,text:"文本框",size:10,selected:{"font-size":20,fill:"red"},defAtrr:{"font-size":10,fill:"black"}},l=function(){function t(t){if(this.config=t,this.raphael=r.a.createInstance(t),this._configMergeToDefule(),this._rIdx=0,this._code2EidDick={},this._LineDragingP=null,this.flow=new n.a(this.raphael),this.nodeQueues=[],this.lineQueues=[],this.textQueues=[],this.tempNodes=[],this.MagneticCore=null,this.config.noToolBar||this._toolbar(),this.config.stepCfg)try{this.loadStep(this.config.stepCfg)}catch(t){console.log(t)}}return t.prototype._configMergeToDefule=function(){var t=this.config.pkgClr||{};t.start=t.start||"rgb(181, 216, 126)",t.opera=t.opera||"rgb(224, 223, 226)",t.judge=t.judge||"rgb(49, 174, 196)",t.end=t.end||"rgb(34, 185, 41)",t.arrow=t.arrow||"rgb(3, 84, 41)",t.NodeBox=t.NodeBox||"rgb(15, 13, 105)",this.config.pkgClr=t,this.config.prefCode=this.config.prefCode||"A",this.config.listener=this.config.listener||{},this.config.noToolBar=this.config.noToolBar||!1},t.prototype._toolbar=function(){var t={},e=this.raphael,o=5,r=5,n=this.config.pkgClr;t.containerIst=e.rect(5,5,75,300),t.containerIst.attr("fill","#ffffff"),o+=20,r+=50,t.startIst=e.ellipse(o,r,8,6),t.startIst.attr("fill",n.start),t.startTxtIst=e.text(o+30,r,s.text),r+=20,t.operaIst=e.rect(o-8,r,16,12),t.operaIst.attr("fill",n.opera),t.operaTxtIst=e.text(o+30,r+4,p.text),r+=30,t.judgeIst=new i.a(e).onlyCell(o,r,16,12),t.judgeIst.attr("fill",n.judge),t.judgeTxtIst=e.text(o+30,r,c.text),r+=30,t.endIst=e.ellipse(o,r,8,6),t.endIst.attr("fill",n.end),t.endTxtIst=e.text(o+30,r,h.text),r+=30,t.arrowIst=this.flow.arrow([o-5,r],[o+10,r],3),t.arrowIst.c.attr("fill",n.arrow),t.arrowTxtIst=e.text(o+30,r,u.text),r+=30,t.textInst=this.raphael.text(o+10,r,f.text),this.$tool=t,this._toolbarDragEvt()},t.prototype._toolbarDragEvt=function(){var t=this,e=this.config.pkgClr,o=function(e,o){t.MagneticCore=null;var r={dx:0,dy:0};e.drag(function(e,o){e+=r.dx,o+=r.dy;var i=t.getLastElem();i&&i.move(e,o)},function(){var e,i;if(2==o)e=this.attr("x"),i=this.attr("y");else if(3==o){var n=this.attr("path")[0];e=n[1],i=n[2]}else e=this.attr("cx"),i=this.attr("cy");r.dx=e+5,r.dy=i+10,t._createNode(r,o)},function(){})};o(this.$tool.startIst,s.type),o(this.$tool.startTxtIst,s.type),o(this.$tool.operaIst,p.type),o(this.$tool.operaTxtIst,p.type),o(this.$tool.judgeIst,c.type),o(this.$tool.judgeTxtIst,c.type),o(this.$tool.endIst,h.type),o(this.$tool.endTxtIst,h.type);var r=function(o){var r={x:0,y:0},i=null;o.drag(function(t,e){t+=r.x,e+=r.y,i&&i.updatePath([t,e],[t+50,e])},function(){if("text"==o.type)r.x=o.attr("x"),r.y=o.attr("y");else{var n=o.attr("path");n=n[0],r.x=n[1],r.y=n[2]}(i=t.flow.arrow([r.x,r.y],[r.x+50,r.y],5)).c.attr("fill",e.arrow),t._lineTragEvent(i),t.lineQueues.push(i)},function(){})};r(this.$tool.arrowIst.c),r(this.$tool.arrowTxtIst),function(){var e={x:0,y:0},o=null;t.$tool.textInst.drag(function(t,r){t+=e.x,r+=e.y,o&&o.attr({x:t,y:r})},function(){e.x=this.attr("x")+5,e.y=this.attr("y")+5,o=t.raphael.text(e.x,e.y,"文本框"),t._textBindEvent(o),t.textQueues.push(o)},function(){})}()},t.prototype._getOrderCode=function(){this._rIdx+=1;var t=this.config.prefCode+this._rIdx;return this._code2EidDick[t]&&(t=this._getOrderCode()),t},t.prototype.removeBBox=function(){this.MagneticCore=null;for(var t=this.nodeQueues,e=0;e<t.length;e++){var o=t[e];o.bBox&&(o.bBox.remove(),o.bBox=null)}this.removeTempNodes();for(var r=this.lineQueues,i=0;i<r.length;i++){var n=r[i];r.selectEdMk&&(n.selectEdMk=!1)}this.removeIntersectMk(),this._removeTxtSelect(),this.tempNodes=[]},t.prototype.removeTempNodes=function(){for(var t=this.tempNodes,e=0;e<t.length;e++){t[e].remove()}},t.prototype.removeNode=function(t){if(t||(t=this.getSelected()),t){var e="object"==typeof t?t:this._code2EidDick[t]?this.raphael.getById(this._code2EidDick[t]):this.raphael.getById(t);if("object"==typeof e){var o=e.id,r=!1;if("arrow"==e.NodeType&&(r=!0),e.bBox&&(e.bBox.remove(),e.bBox=null),e.label&&(e.label.remove(),e.label=null),e.selectEdMk&&(e.selectEdMk=!1),e.c.remove(),e=null,r){for(var i=this.lineQueues,n=[],a=0;a<i.length;a++){var s=i[a];o!=s.c.id&&n.push(s)}this.lineQueues=n}else{for(var p=this.nodeQueues,c=[],h=0;h<p.length;h++){var u=p[h];o!=u.c.id&&c.push(u)}this.nodeQueues=c}return this.removeBBox(),!0}}return!1},t.prototype.removeIntersectMk=function(){for(var t=this.nodeQueues,e=null,o=0;o<t.length;o++){var r=t[o];if(r._IntersectMk){r._IntersectMk=!1;var i=r.NodeType,n=this.config.pkgClr;n[i]?r.c.attr("fill",n[i]):1==(i=r.c.data("type"))?r.c.attr("fill",n.start):9==i&&r.c.attr("fill",n.end),e=r}}return e},t.prototype.removeConLine=function(t,e){if(t&&e)for(var o=this.nodeQueues,r=t.c.id,i=0;i<o.length;i++){var n=o[i],a=e+"Line";if(n[a]&&n[a].length){for(var s=n[a],p=[],c=0;c<s.length;c++){var h=s[c];r!=h.c.id&&p.push(h)}n[a]=p}}return!1},t.prototype.removeAll=function(){return this.removeAllText(),this.removeAllLine(),this.removeAllNode(),this},t.prototype.removeAllNode=function(){this.removeBBox();for(var t=this.nodeQueues,e=0;e<t.length;e++){var o=t[e];o.label&&o.label.remove(),o.c.remove()}return this.nodeQueues=[],this},t.prototype.removeAllLine=function(){this.removeBBox();for(var t=this.lineQueues,e=0;e<t.length;e++){t[e].c.remove()}return this.lineQueues=[],this},t.prototype.removeAllText=function(){this.removeBBox();for(var t=this.textQueues,e=0;e<t.length;e++){t[e].remove()}return this.textQueues=[],this},t.prototype.getNodeByCode=function(t){for(var e=null,o=this.nodeQueues,r=0;r<o.length;r++){var i=o[r];if(i.c.data("code")==t){e=i;break}}return e},t.prototype.getNodeByEid=function(t){for(var e=null,o=this.nodeQueues,r=0;r<o.length;r++){var i=o[r];if(i.c.id==t){e=i;break}}return e},t.prototype.code2Id=function(t,e){if(t&&!e)return this._code2EidDick[t]||null;if(e&&!t){var o=this._code2EidDick;for(var r in o)if(e==o[r])return r;return null}return e&&t?(this._code2EidDick[t]=e,this):void 0},t.prototype.setOption=function(t,e){if(t){"object"!=typeof t&&(t={text:t}),e||(e=this.getSelected());var o="object"==typeof e?e:this.getNodeByCode(e);o&&t.text&&o.label&&(o.label.attr("text",t.text),o.opt=o.opt||{},o.opt.text=t.text,"function"==typeof o.resizeByText&&o.resizeByText())}return!1},t.prototype.cloneNode=function(t){if(t||(t=this.getSelected()),t){var e="object"==typeof t?t:this.raphael.getById(t);if("object"==typeof e){e.id;return e.c.clone(),e.label.clone(),!0}}return!1},t.prototype.getSelected=function(){for(var t=this.nodeQueues,e=null,o=0;o<t.length;o++){var r=t[o];if(r.bBox){e=r;break}}if(!e)for(var i=this.lineQueues,n=0;n<i.length;n++){var a=i[n];a.selectEdMk&&(e=a)}return e},t.prototype.getLastElem=function(){var t=null,e=this.nodeQueues;return e.length>0&&(t=e[e.length-1]),t},t.prototype.getFlowStep=function(){for(var t=[],e=this.nodeQueues,o=0;o<e.length;o++){var r=e[o],i=this.getFlowJson(r);t.push(i)}return t},t.prototype.getFlowJson=function(t){t||(t=this.getSelected());var e={};if(t){var o=t.label||null,r=t.c;e={name:o?o.attr("text"):"",code:r.data("code"),type:r.data("type"),_struct:t.toJson()};for(var i=t.toLine,n=[],a=0;a<i.length;a++){(h=this.getLineCntCode("from",i[a].c.id,t))&&n.push(h)}e.prev=n.length>0?n.join(","):"";for(var s=t.fromLine,p=[],c=0;c<s.length;c++){var h;(h=this.getLineCntCode("to",s[c].c.id,t))&&p.push(h)}e.next=p.length>0?p.join(","):""}else e=null;return e},t.prototype.getLineCntCode=function(t,e,o){if(t&&e){var r=this.nodeQueues,i=null;o&&(i="string"==typeof o?o:o.c.data("code"));for(var n=t+"Line",a=0;a<r.length;a++){var s=r[a],p=s.c.data("code");if(i!=p)for(var c=s[n],h=0;h<c.length;h++){if(e==c[h].c.id)return p}}}return null},t.prototype.getIntersectElem=function(t){var e=null;if("object"==typeof t)for(var o=this.nodeQueues,r=0;r<o.length;r++){var i=o[r],n=i.NodeType;if("endpnt"==n){var a=(h=i.c).attr("cx"),s=h.attr("cy"),p=h.attr("rx"),c=h.attr("ry");if(t.x>=a-p&&t.x<=a+p&&t.y>=s-c&&t.y<=s+c){e=i;break}}else if("opera"==n){var h,u=(h=i.c).attr("x"),f=h.attr("y"),l=h.attr("width"),y=h.attr("height");if(t.x>=u&&t.x<=u+l&&t.y>=f&&t.y<=f+y){e=i;break}}else if("judge"==n){var x=i.opt;a=x.cx,s=x.cy,y=x.h,l=x.w;if(t.x>=a-l/2&&t.x<=a+l/2&&t.y>=s-y/2&&t.y<=s+y/2){e=i;break}}}return e},t.prototype.loadStep=function(t){if("object"==typeof t){for(var e={},o=this.config.pkgClr,r=function(t,o){if(-1==t.indexOf(","))for(var r=-1==o.indexOf(",")?[o]:o.split(","),i=0;i<r.length;i++){var n=t+"__"+r[i];e[n]||(e[n]=!0)}else if(-1==o.indexOf(","))for(var a=-1==t.indexOf(",")?[t]:t.split(","),s=0;s<a.length;s++){n=a[s]+"__"+o;e[n]||(e[n]=!0)}},i=0;i<t.length;i++){var n=t[i],a=n._struct.opt,s=(o=this.config.pkgClr,n.type),p=null;if(1==s||9==s?(p=this.flow.endpoint(a.cx,a.cy,a.r,a.text),1==s?p.c.attr("fill",o.start):p.c.attr("fill",o.end)):2==s?(p=this.flow.operation(a.cx,a.cy,a.w,a.h,a.text)).c.attr("fill",o.opera):3==s&&(p=this.flow.judge(a.cx,a.cy,a.w,a.h,a.text)).c.attr("fill",o.judge),p){var c=n.code||p.c.data("code"),h=p.c.id;c||(c=this._getOrderCode()),p.c.data("code",c),this._code2EidDick[c]=h,p.c.data("type",s),this._bindEvent(p),this.nodeQueues.push(p);var u=n.prev||null;u&&r(u,c);var f=n.next||null;f&&r(c,f)}}for(var l in e){var y=l.split("__"),x=this.getNodeByCode(y[0]),d=this.getNodeByCode(y[1]),v=x.getStlnP(),g=d.getEnlnP(),w=this.flow.arrow([v.x,v.y],[g.x,g.y],5);w.position||(w.position={}),w.position.from=v.position,x.recordLine("from",w),d.recordLine("to",w),w.position.to=g.position,w.c.attr("fill",o.arrow),this._lineTragEvent(w),this.lineQueues.push(w)}}return this},t.prototype._createNode=function(t,e){var o=null,r=this.config.pkgClr;switch(e){case 1:(o=this.flow.endpoint(t.dx,t.dy,10,"开始")).c.attr("fill",r.start);break;case 2:(o=this.flow.operation(t.dx,t.dy,50,40,"操作流程")).c.attr("fill",r.opera);break;case 3:(o=this.flow.judge(t.dx,t.dy,50,40,"流程判断")).c.attr("fill",r.judge);break;case 9:(o=this.flow.endpoint(t.dx,t.dy,10,"结束")).c.attr("fill",r.end)}if(o){var i=this._getOrderCode();o.c.data("code",i),this._code2EidDick[i]=o.c.id,o.c.data("type",e),this._bindEvent(o),this.nodeQueues.push(o)}},t.prototype._bindEvent=function(t){if(t){var e=this,o=this.config.pkgClr;!function(){var e={x:0,y:0};t.c.drag(function(o,r){o+=e.x,r+=e.y,t.move(o,r),t.ToSyncArrow(o,r)},function(){var t,o;if("ellipse"==this.type)t=this.attr("cx"),o=this.attr("cy");else if("rect"==this.type)t=this.attr("x"),o=this.attr("y");else if("path"==this.type){var r=this.attr("path")[0];t=r[1],o=r[2]}e.x=t,e.y=o},function(){e={x:0,y:0}})}(),t.c.click(function(){e.removeBBox();var r=this.getBBox();t.bBox=t.instance.rect(r.x-5,r.y-5,r.width+10,r.height+10),t.bBox.attr({stroke:o.NodeBox}),e.onNodeClick(t)})}},t.prototype._lineTragEvent=function(t){if(!t||"object"!=typeof t)return!1;var e=this;return function(t){t.c.click(function(){e.removeBBox(),t.selectEdMk=!0;var o=t.opt,r=e.raphael.circle(o.p1[0],o.p1[1],3);r.attr("fill","#000000");var i=e.raphael.circle(o.p2[0],o.p2[1],3);i.attr("fill","#000000");var n=function(o,r){var i={ax:0,ay:0};o.drag(function(o,n){o+=i.ax,n+=i.ay;var a=e.getIntersectElem({x:o,y:n});if(a){e.removeIntersectMk(),a.c.attr("fill","#FF0000"),a._IntersectMk=!0;var s;o=(s=r?a.getEnlnP():a.getStlnP()).x,n=s.y;var p=r?"to":"from";e.removeConLine(t,p),a.recordLine(p,t),t.position||(t.position={}),t.position[p]=s.position}r?(t.updatePath(null,[o,n]),this.data("type","to")):(t.updatePath([o,n]),this.data("type","from")),e.MagneticCore=this,this.attr({cx:o,cy:n})},function(){i.ax=this.attr("cx"),i.ay=this.attr("cy")},function(){e.MagneticCore=null})};n(r),n(i,!0),e.tempNodes.push(r,i)})}(t),!0},t.prototype._textBindEvent=function(t){var e=this;!function(t){var e={x:0,y:0};t.drag(function(o,r){o+=e.x,r+=e.y,t.attr({x:o,y:r})},function(){e.x=t.attr("x"),e.y=t.attr("y")},function(){})}(t),t.click(function(){e.removeBBox(),this.attr(f.selected),this.data("selectMk",!0)})},t.prototype._removeTxtSelect=function(){for(var t=this.textQueues,e=0;e<t.length;e++){var o=t[e];o.data("selectMk")&&(o.attr(f.defAtrr),o.data("selectMk",!1))}},t.prototype.onNodeClick=function(t){},t.version=a.a,t}();e.default=l},function(t,e,o){"use strict";var r=0,i={},n=function(){function t(){}return t.createInstance=function(t){return(t="object"==typeof t?t:{}).dom,"string"==typeof t.dom&&(t.dom=$(t.dom)),t.w||(t.w=1.1*$(window).width()),t.h||(t.h=1.1*$(window).height()),Raphael(t.dom.get(0),t.w,t.h)},t.onMoveEvt=function(){},t.onStartEvt=function(){},t.onEndEvt=function(){},t.getIndex=function(){return r+=1},t.src=function(t,e,o){i[t]||(i[t]={});var r=i[t];return void 0===e?r:void 0===o?r[e]||null:void(r[e]=o)},t}();e.a=n},function(t,e,o){"use strict";o.d(e,"a",function(){return c});var r=o(5),i=o(6),n=o(1),a=o(7),s=o(9),p=o(10),c=function(){function t(t){this.paper=t}return t.prototype.endpoint=function(t,e,o,i){var n=new r.a(this.paper);return n.create({cx:t,cy:e,r:o,text:i}),n},t.prototype.judge=function(t,e,o,r,i){var a=new n.a(this.paper);return a.create({cx:t,cy:e,w:o,h:r,text:i}),a},t.prototype.operation=function(t,e,o,r,n){var a=new i.a(this.paper);return a.create({cx:t,cy:e,w:o,h:r,text:n}),a},t.prototype.line=function(t,e){var o=new a.a(this.paper);return o.create(t,e),o},t.prototype.rightAngleLine=function(t){var e=new a.a(this.paper);return e.RightAngle(t),e},t.prototype.arrow=function(t,e,o){var r=new s.a(this.paper);return r.create(t,e,o),r},t.prototype.bow=function(t){var e=new p.a(this.paper);return e.create(t),e},t.prototype.getEmptyNode=function(t){var e=null;switch(t){case"endpoint":e=new r.a(this.paper);break;case"judge":e=new n.a(this.paper);break;case"operation":e=new i.a(this.paper);break;case"line":e=new a.a(this.paper);break;case"arrow":e=new s.a(this.paper)}return e},t}()},function(t,e,o){"use strict";var r=o(0),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=function(t){function e(e){var o=t.call(this)||this;return o.NodeType="endpnt",o.instance=e,o.opt={},o}return i(e,t),e.prototype.create=function(t){if("object"!=typeof t){var e=arguments;t={cx:e[0],cy:e[1],r:e[2]},e[3]&&(t.text=e[3])}t.h=t.h?t.h:t.r,this.minWidth=2*t.r,this.opt=t,this.c=this.instance.ellipse(t.cx,t.cy,t.r,t.h);var o;o=t.text?this.instance.text(t.cx,t.cy,t.text):this.instance.text(t.cx,t.cy),this.label=o,this.resizeByText()},e.prototype.resizeByText=function(){if(this.label){var t=this.label.getBBox(),e=Math.ceil(t.width),o=this.c.attr("rx");if(e<this.minWidth&&o<this.minWidth)return;e<this.minWidth?e=this.minWidth:e+=2,this.opt.r=e/2,this.resizeByOpt()}},e.prototype.resizeByOpt=function(){var t=this.opt;this.c.attr({cx:t.cx,cy:t.cy,rx:t.r,ry:t.h})},e.prototype.move=function(t,e){this.c.attr({cx:t,cy:e}),this.label.attr({x:t,y:e}),this.opt.cx=t,this.opt.cy=e},e.prototype.ToSyncLine=function(t,e){var o=this;this.syncLineMove(function(r,i,n){var a,s=n.position;if("from"==i){var p=r.attr("path");a="get"+s.from+"p";var c=o[a](t,e);p[0]=["M",c.x,c.y],r.attr("path",p)}else if("to"==i){var h=r.attr("path");a="get"+s.to+"p";var u=o[a](t,e);h[h.length-1]=["L",u.x,u.y],r.attr("path",h)}})},e.prototype.ToSyncArrow=function(t,e){var o=this;this.syncLineMove(function(r,i,n){var a,s=n.position;if("from"==i){a="get"+s.from+"p";var p=o[a](t,e);n.updatePath([p.x,p.y])}else if("to"==i){a="get"+s.to+"p";var c=o[a](t,e);n.updatePath(null,[c.x,c.y])}})},e.prototype.getStlnP=function(t){var e=this["get"+(t=t||"D")+"p"]();return e.position=t,e},e.prototype.getEnlnP=function(t){var e=this["get"+(t=t||"B")+"p"]();return e.position=t,e},e.prototype.getAp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t-=o.r,{x:t,y:e}},e.prototype.getBp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,e-=o.r,{x:t,y:e}},e.prototype.getCp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t+=o.r,{x:t,y:e}},e.prototype.getDp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,e+=o.r,{x:t,y:e}},e}(r.a);e.a=n},function(t,e,o){"use strict";var r=o(0),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=function(t){function e(e){var o=t.call(this)||this;return o.NodeType="opera",o.instance=e,o.opt={},o.bBox=null,o}return i(e,t),e.prototype.create=function(t){this.opt=t,this.minWidth=t.w;var e=this.getAp();this.c=this.instance.rect(e.x,e.y,t.w,t.h);var o;o=t.text?this.instance.text(t.cx,t.cy,t.text):this.instance.text(t.cx,t.cy),this.label=o,this.resizeByText()},e.prototype.resizeByText=function(){if(this.label){var t=this.label.getBBox(),e=Math.ceil(t.width),o=this.c.attr("w");if(e<this.minWidth&&o<this.minWidth)return;e<this.minWidth?e=this.minWidth:e+=10,this.opt.w=e;var r=this.getAp();this.c.attr({width:e,x:r.x,y:r.y})}},e.prototype.move=function(t,e){var o=this.getCtpByAp(t,e);this.c.attr({x:t,y:e}),this.label.attr(o),this.opt.cx=t,this.opt.cy=e},e.prototype.ToSyncLine=function(t,e){var o=this,r=this.getCtpByAp(t,e);this.syncLineMove(function(t,e,i){var n,a=i.position;if("from"==e){var s=t.attr("path");n="get"+a.from+"p";var p=o[n](r.x,r.y);s[0]=["M",p.x,p.y],t.attr("path",s)}else if("to"==e){n="get"+a.to+"p";var c=o[n](r.x,r.y),h=t.attr("path");h[h.length-1]=["L",c.x,c.y],t.attr("path",h)}})},e.prototype.ToSyncArrow=function(t,e){var o=this,r=this.getCtpByAp(t,e);this.syncLineMove(function(t,e,i){var n,a=i.position;if("from"==e){n="get"+a.from+"p";var s=o[n](r.x,r.y);i.updatePath([s.x,s.y])}else if("to"==e){n="get"+a.to+"p";var p=o[n](r.x,r.y);i.updatePath(null,[p.x,p.y])}})},e.prototype.getStlnP=function(t){var e=this["get"+(t=t||"Bt")+"p"]();return e.position=t,e},e.prototype.getEnlnP=function(t){var e=this["get"+(t=t||"T")+"p"]();return e.position=t,e},e.prototype.getCtpByAp=function(t,e){var o=this.opt;return t+=o.w/2,e+=o.h/2,{x:t,y:e}},e.prototype.getAp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t-=o.w/2,e-=o.h/2,{x:t,y:e}},e.prototype.getBp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t-=o.w/2,e+=o.h/2,{x:t,y:e}},e.prototype.getCp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t+=o.w/2,e+=o.h/2,{x:t,y:e}},e.prototype.getDp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t-=o.w/2,e+=o.h/2,{x:t,y:e}},e.prototype.getTp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,e-=o.h/2,{x:t,y:e}},e.prototype.getRp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t+=o.w/2,{x:t,y:e}},e.prototype.getBtp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,e+=o.h/2,{x:t,y:e}},e.prototype.getLp=function(t,e){var o=this.opt;return t=t||o.cx,e=e||o.cy,t-=o.w/2,{x:t,y:e}},e}(r.a);e.a=n},function(t,e,o){"use strict";var r=o(8),i=function(){function t(t){this.NodeType="line",this.instance=t,this.opt={},this.position={},this.rightAngle=!1}return t.prototype.create=function(t,e){this.opt={p1:t,p2:e},this.c=this.instance.path("M"+t[0]+","+t[1]+"L"+e[0]+","+e[1])},t.prototype.RightAngle=function(t){this.opt=t,this.rightAngle=!0;var e=t.p1,o=t.p2,r=20;t.d&&(r=t.d);var i="";if(e.x!=o.x&&e.y!=o.y){var n=o.x-e.x;i="L"+(e.x+n+r*(n>0?1:-1))+","+e.y+"L"+(e.x+n+r*(n>0?1:-1))+","+o.y}this.c=this.instance.path("M"+e.x+","+e.y+i+"L"+o.x+","+o.y)},t.prototype.createByPoint=function(t){this.opt=t;var e="";r.a.each(this.opt.points,function(t,o){o&&(e+=(e?"L":"M")+o.x+","+o.y)}),this.c=this.instance.path(e)},t}();e.a=i},function(t,e,o){"use strict";o.d(e,"a",function(){return r});var r=function(){function t(){}return t.clone=function(t){t="object"==typeof t?t:{};return $.extend(!0,{},t)},t.ArrayMergeSameValue=function(t){if("object"==typeof t&&t.length&&t.length>1){for(var e={},o=[],r=0;r<t.length;r++)e[t[r]]||(o.push(t[r]),e[t[r]]=!0);t=o}return t},t.each=function(t,e){if("object"==typeof t)if($.isArray(t))for(var o=0;o<t.length&&!1!==e(o,t[o]);o++);else for(var r in t)if(!1===e(r,t[r]))break},t}()},function(t,e,o){"use strict";var r=function(){function t(t){this.NodeType="arrow",this.instance=t,this.opt={},this.position={}}return t.prototype.create=function(t,e,o){this.opt={p1:t,p2:e,r:o};var r=this.getPoints();this.c=this.instance.path("M"+t[0]+","+t[1]+"L"+e[0]+","+e[1]+"L"+r.cP.x+","+r.cP.y+"L"+r.dP.x+","+r.dP.y+"L"+e[0]+","+e[1])},t.prototype.getPoints=function(t,e,o){var r=this.opt;t||(t=r.p1),e||(e=r.p2),o||(o=r.r);var i=Math.atan2(t[1]-e[1],e[0]-t[0])*(180/Math.PI),n=e[0]-o*Math.cos(i*(Math.PI/180)),a=e[1]+o*Math.sin(i*(Math.PI/180));return{cP:{x:n+o*Math.cos((i+120)*(Math.PI/180)),y:a-o*Math.sin((i+120)*(Math.PI/180))},dP:{x:n+o*Math.cos((i+240)*(Math.PI/180)),y:a-o*Math.sin((i+240)*(Math.PI/180))}}},t.prototype.updatePath=function(t,e,o){var r=this.opt;t||(t=r.p1),e||(e=r.p2),o||(o=r.r);var i=this.getPoints(t,e,o);this.c.attr("path",[["M",t[0],t[1]],["L",e[0],e[1]],["L",i.cP.x,i.cP.y],["L",i.dP.x,i.dP.y],["L",e[0],e[1]]]),this.opt={p1:t,p2:e,r:o}},t}();e.a=r},function(t,e,o){"use strict";var r=function(){function t(t){this.NodeType="bow",this.instance=t,this.opt={},this.position={}}return t.prototype.create=function(t){this.opt=t,this.queueCheck(),this.bodySharp(),this.arrowSharp()},t.prototype.arrowSharp=function(){var t=this.opt,e=t.queue,o=t.r?t.r:5,r=e.length,i=e[r-1],n=e[r-2],a=Math.atan2(n.y-i.y,i.x-n.x)*(180/Math.PI),s=i.x-o*Math.cos(a*(Math.PI/180)),p=i.y+o*Math.sin(a*(Math.PI/180)),c=s+o*Math.cos((a+120)*(Math.PI/180)),h=p-o*Math.sin((a+120)*(Math.PI/180)),u=s+o*Math.cos((a+240)*(Math.PI/180)),f=p-o*Math.sin((a+240)*(Math.PI/180));this.arrow?this.arrow.attr("path",[["M",i.x,i.y],["L",c,h],["L",u,f],["L",i.x,i.y]]):this.arrow=this.instance.path("M"+i.x+","+i.y+"L"+c+","+h+"L"+u+","+f+"L"+i.x+","+i.y)},t.prototype.bodySharp=function(){var t=this.opt.queue,e="",o=[],r=!1,i=!0;r=!!this.c;for(var n=0;n<t.length;n++){var a=t[n];r?(i&&o.length>0&&(i=!1),o.push([i?"M":"L",a.x,a.y])):e+=(e?"L":"M")+","+a.x+","+a.y}r?this.c.attr("path",o):this.c=this.instance.path(e)},t.prototype.queueCheck=function(){var t=this.opt.queue;if(2==t.length){var e=[],o=t[0],r=t[1];o.x<r.x?e.push({x:r.x,y:o.y}):o.x>r.x&&(e.push({x:o.x,y:r.y-20}),e.push({x:r.x,y:r.y-20})),this.opt.queue=[o].concat(e,r)}},t.prototype.updatePath=function(t,e,o){var r=this.opt;if(t&&(r.queue[0]={x:t[0],y:t[1]}),e){var i=r.queue.length-1;r.queue[i]={x:e[0],y:e[1]}}this.queueCheck(),this.bodySharp(),this.arrowSharp()},t}();e.a=r},function(t,e,o){"use strict";o.d(e,"a",function(){return r});var r={version:"2.0.1",release:"20180323",author:"Joshua Conero"}}]);